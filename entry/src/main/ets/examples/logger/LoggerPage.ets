import { BusinessError } from '@kit.BasicServicesKit';
import { common } from '@kit.AbilityKit';
import { ServerInfo } from '@cxy/webserver';

// import { LoggerExample } from './LoggerExample';

@Builder
function loggerBuilder() {
  LoggerPage()
}

@Component
struct LoggerPage {
  build() {

  }

  // @State title: string = 'Loggerç¤ºä¾‹'
  // @State loggerExample: LoggerExample | null = null;
  // @State serverInfo: ServerInfo | null = null;
  // @State port: number = 8085;
  // @State errorMessage: string = '';
  // @State successMessage: string = '';
  // @State logCount: number = 0;
  // @State logFormat: string = 'dev';
  // @State logLevel: string = 'info';
  //
  // aboutToAppear() {
  //   setTimeout(() => {
  //     this.startServer();
  //   }, 0);
  // }
  //
  // aboutToDisappear() {
  //   this.stopServer();
  // }
  //
  // /**
  //  * åˆå§‹åŒ–Loggerç¤ºä¾‹
  //  */
  // async initializeExample() {
  //   this.errorMessage = '';
  //   const context = this.getUIContext().getHostContext() as common.UIAbilityContext;
  //   this.loggerExample = new LoggerExample(context, {
  //     port: this.port,
  //     enableCors: true,
  //     logFormat: this.logFormat as ESObject,
  //     logLevel: this.logLevel as ESObject,
  //     logToFile: true
  //   });
  //   await this.loggerExample.setupStaticFiles();
  // }
  //
  // /**
  //  * å¯åŠ¨æœåŠ¡å™¨
  //  */
  // async startServer() {
  //   if (!this.loggerExample) {
  //     await this.initializeExample();
  //   }
  //
  //   if (!this.loggerExample) {
  //     this.errorMessage = 'LoggeræœåŠ¡å™¨åˆå§‹åŒ–å¤±è´¥';
  //     return;
  //   }
  //
  //   try {
  //     this.errorMessage = '';
  //
  //     const info = await this.loggerExample.start();
  //
  //     if (info) {
  //       this.serverInfo = info;
  //       this.successMessage = `ðŸ“ LoggeræœåŠ¡å™¨è¿è¡Œä¸­`;
  //       this.startStatsUpdate();
  //     } else {
  //       this.errorMessage = 'LoggeræœåŠ¡å™¨å¯åŠ¨å¤±è´¥ï¼ŒæœªèŽ·å–åˆ°åœ°å€';
  //     }
  //   } catch (error) {
  //     const businessError = error as BusinessError;
  //     this.errorMessage = `å¯åŠ¨å¤±è´¥: ${businessError.message}`;
  //   }
  // }
  //
  // /**
  //  * åœæ­¢æœåŠ¡å™¨
  //  */
  // async stopServer() {
  //   if (!this.loggerExample) {
  //     return;
  //   }
  //
  //   try {
  //     await this.loggerExample.stop();
  //
  //     this.loggerExample = null;
  //     this.serverInfo = null;
  //     this.successMessage = 'ðŸ“ LoggeræœåŠ¡å™¨å·²åœæ­¢';
  //     this.logCount = 0;
  //
  //   } catch (error) {
  //     this.errorMessage = `åœæ­¢æœåŠ¡å™¨å¤±è´¥: ${error}`;
  //   }
  // }
  //
  // /**
  //  * å¯åŠ¨ç»Ÿè®¡æ•°æ®æ›´æ–°
  //  */
  // startStatsUpdate() {
  //   const updateStats = () => {
  //     if (this.loggerExample) {
  //       this.logCount = this.loggerExample.getLogCount();
  //     }
  //   };
  //
  //   updateStats();
  //   setInterval(updateStats, 2000);
  // }
  //
  // /**
  //  * æ›´æ–°ç«¯å£å·
  //  */
  // updatePort(newPort: string) {
  //   const portNum = parseInt(newPort);
  //   if (portNum > 0 && portNum <= 65535) {
  //     this.port = portNum;
  //     this.errorMessage = '';
  //   } else {
  //     this.errorMessage = 'ç«¯å£å·å¿…é¡»åœ¨1-65535ä¹‹é—´';
  //   }
  // }
  //
  // /**
  //  * æ¸…é™¤æ¶ˆæ¯
  //  */
  // clearMessages() {
  //   this.errorMessage = '';
  //   this.successMessage = '';
  // }
  //
  // build() {
  //   NavDestination() {
  //     Column() {
  //       // æ¶ˆæ¯æ˜¾ç¤ºåŒºåŸŸ
  //       if (this.errorMessage) {
  //         Text(this.errorMessage)
  //           .fontColor(Color.Red)
  //           .fontSize(14)
  //           .margin({ bottom: 10 })
  //           .padding(10)
  //           .backgroundColor('#ffebee')
  //           .borderRadius(8)
  //           .width('90%')
  //           .textAlign(TextAlign.Center)
  //       } else if (this.successMessage) {
  //         Text(this.successMessage)
  //           .fontColor(Color.Green)
  //           .fontSize(14)
  //           .margin({ bottom: 10 })
  //           .padding(10)
  //           .backgroundColor('#e8f5e8')
  //           .borderRadius(8)
  //           .width('90%')
  //           .textAlign(TextAlign.Center)
  //       }
  //
  //       // æœåŠ¡å™¨çŠ¶æ€åŒºåŸŸ
  //       if (this.serverInfo) {
  //         Column({ space: 15 }) {
  //           // æœåŠ¡å™¨ä¿¡æ¯å¡ç‰‡
  //           Column({ space: 10 }) {
  //             Row() {
  //               Text('ðŸ“ LoggeræœåŠ¡åœ°å€:')
  //                 .fontWeight(FontWeight.Medium)
  //                 .width(120)
  //               Text(`http://${this.serverInfo.address}:${this.serverInfo.port}`)
  //                 .fontColor(Color.Blue)
  //                 .fontSize(16)
  //             }
  //             .width('100%')
  //             .justifyContent(FlexAlign.Start)
  //
  //             Row() {
  //               Text('æ—¥å¿—æ ¼å¼:')
  //                 .fontWeight(FontWeight.Medium)
  //                 .width(120)
  //               Text(this.logFormat.toUpperCase())
  //                 .fontSize(14)
  //                 .fontColor(Color.Green)
  //             }
  //             .width('100%')
  //             .justifyContent(FlexAlign.Start)
  //
  //             Row() {
  //               Text('æ—¥å¿—çº§åˆ«:')
  //                 .fontWeight(FontWeight.Medium)
  //                 .width(120)
  //               Text(this.logLevel.toUpperCase())
  //                 .fontSize(14)
  //                 .fontColor(Color.Orange)
  //             }
  //             .width('100%')
  //             .justifyContent(FlexAlign.Start)
  //           }
  //           .padding(15)
  //           .backgroundColor('#f0f8ff')
  //           .borderRadius(10)
  //           .width('90%')
  //
  //           // æ—¥å¿—ç»Ÿè®¡
  //           Column({ space: 10 }) {
  //             Text('ðŸ“Š æ—¥å¿—ç»Ÿè®¡')
  //               .fontWeight(FontWeight.Bold)
  //               .fontSize(16)
  //               .margin({ bottom: 5 })
  //
  //             Row() {
  //               Text('æ—¥å¿—æ¡æ•°:')
  //                 .fontWeight(FontWeight.Medium)
  //                 .width(80)
  //               Text(this.logCount.toString())
  //                 .fontSize(16)
  //                 .fontColor(Color.Blue)
  //             }
  //             .width('100%')
  //             .justifyContent(FlexAlign.Start)
  //           }
  //           .padding(15)
  //           .backgroundColor('#f0fff0')
  //           .borderRadius(10)
  //           .width('90%')
  //
  //           // æ—¥å¿—ç‰¹æ€§
  //           Column({ space: 8 }) {
  //             Text('ðŸ“ Loggerç‰¹æ€§')
  //               .fontWeight(FontWeight.Bold)
  //               .fontSize(16)
  //               .margin({ bottom: 5 })
  //
  //             Text('âœ… å¤šæ ¼å¼æ—¥å¿—è®°å½•')
  //               .fontSize(12)
  //               .fontColor('#666')
  //             Text('âœ… æ—¥å¿—çº§åˆ«æŽ§åˆ¶')
  //               .fontSize(12)
  //               .fontColor('#666')
  //             Text('âœ… æ–‡ä»¶æ—¥å¿—å­˜å‚¨')
  //               .fontSize(12)
  //               .fontColor('#666')
  //             Text('âœ… æ—¥å¿—ç»Ÿè®¡åˆ†æž')
  //               .fontSize(12)
  //               .fontColor('#666')
  //             Text('âœ… å®žæ—¶æ—¥å¿—æŸ¥çœ‹')
  //               .fontSize(12)
  //               .fontColor('#666')
  //             Text('âœ… åŠ¨æ€é…ç½®ç®¡ç†')
  //               .fontSize(12)
  //               .fontColor('#666')
  //           }
  //           .alignItems(HorizontalAlign.Start)
  //           .padding(15)
  //           .backgroundColor('#fff3e0')
  //           .borderRadius(10)
  //           .width('90%')
  //
  //           // åœæ­¢æŒ‰é’®
  //           Button('åœæ­¢LoggeræœåŠ¡å™¨')
  //             .width('80%')
  //             .height(50)
  //             .backgroundColor('#d32f2f')
  //             .onClick(() => {
  //               this.clearMessages();
  //               this.stopServer();
  //             })
  //         }
  //         .width('100%')
  //
  //       } else {
  //         // æœåŠ¡å™¨æœªè¿è¡ŒçŠ¶æ€
  //         Column({ space: 20 }) {
  //           // é…ç½®åŒºåŸŸ
  //           Column({ space: 15 }) {
  //             Text('LoggeræœåŠ¡å™¨é…ç½®')
  //               .fontWeight(FontWeight.Bold)
  //               .fontSize(16)
  //
  //             Row() {
  //               Text('ç«¯å£å·:')
  //                 .fontWeight(FontWeight.Medium)
  //                 .width(80)
  //               TextInput({
  //                 text: this.port.toString(),
  //                 placeholder: 'è¯·è¾“å…¥ç«¯å£å· (1-65535)'
  //               })
  //                 .type(InputType.Number)
  //                 .layoutWeight(1)
  //                 .height(40)
  //                 .onChange((value) => {
  //                   this.updatePort(value);
  //                 })
  //             }
  //             .width('100%')
  //
  //             Row() {
  //               Text('æ—¥å¿—æ ¼å¼:')
  //                 .fontWeight(FontWeight.Medium)
  //                 .width(80)
  //               Select([
  //                 { value: 'dev' },
  //                 { value: 'combined' },
  //                 { value: 'common' },
  //                 { value: 'short' },
  //                 { value: 'tiny' }
  //               ])
  //                 .selected(0)
  //                 .value(this.logFormat)
  //                 .onSelect((index: number, value?: string) => {
  //                   if (value) {
  //                     this.logFormat = value;
  //                   }
  //                 })
  //                 .layoutWeight(1)
  //                 .height(40)
  //             }
  //             .width('100%')
  //
  //             Row() {
  //               Text('æ—¥å¿—çº§åˆ«:')
  //                 .fontWeight(FontWeight.Medium)
  //                 .width(80)
  //               Select([
  //                 { value: 'debug' },
  //                 { value: 'info' },
  //                 { value: 'warn', },
  //                 { value: 'error' }
  //               ])
  //                 .selected(1)
  //                 .value(this.logLevel)
  //                 .onSelect((index: number, value?: string) => {
  //                   if (value) {
  //                     this.logLevel = value;
  //                   }
  //                 })
  //                 .layoutWeight(1)
  //                 .height(40)
  //             }
  //             .width('100%')
  //           }
  //           .padding(15)
  //           .backgroundColor('#f5f5f5')
  //           .borderRadius(10)
  //           .width('90%')
  //
  //           // åŠŸèƒ½è¯´æ˜Ž
  //           Column({ space: 8 }) {
  //             Text('ðŸ“ LoggeråŠŸèƒ½')
  //               .fontWeight(FontWeight.Bold)
  //               .fontSize(16)
  //               .margin({ bottom: 5 })
  //
  //             Text('ðŸ“Š å¤šæ ¼å¼æ—¥å¿—è®°å½•')
  //               .fontSize(14)
  //               .fontColor('#666')
  //             Text('ðŸ” æ—¥å¿—çº§åˆ«è¿‡æ»¤')
  //               .fontSize(14)
  //               .fontColor('#666')
  //             Text('ðŸ’¾ æ–‡ä»¶æ—¥å¿—å­˜å‚¨')
  //               .fontSize(14)
  //               .fontColor('#666')
  //             Text('ðŸ“ˆ æ—¥å¿—ç»Ÿè®¡åˆ†æž')
  //               .fontSize(14)
  //               .fontColor('#666')
  //             Text('âš™ï¸ åŠ¨æ€é…ç½®ç®¡ç†')
  //               .fontSize(14)
  //               .fontColor('#666')
  //             Text('ðŸ§ª æ—¥å¿—æµ‹è¯•å·¥å…·')
  //               .fontSize(14)
  //               .fontColor('#666')
  //           }
  //           .alignItems(HorizontalAlign.Start)
  //           .padding(15)
  //           .backgroundColor('#e3f2fd')
  //           .borderRadius(10)
  //           .width('90%')
  //
  //           // å¯åŠ¨æŒ‰é’®
  //           Button('å¯åŠ¨LoggeræœåŠ¡å™¨')
  //             .width('80%')
  //             .height(50)
  //             .backgroundColor('#1976d2')
  //             .onClick(() => {
  //               this.clearMessages();
  //               this.startServer();
  //             })
  //         }
  //         .width('100%')
  //       }
  //     }
  //     .width('100%')
  //     .height('100%')
  //     .padding(20)
  //     .justifyContent(FlexAlign.Start)
  //   }
  //   .title(this.title)
  //   .onReady((ctx) => {
  //     if (ctx.pathInfo.param) {
  //       this.title = ctx.pathInfo.param as string;
  //     }
  //   })
  // }
}

